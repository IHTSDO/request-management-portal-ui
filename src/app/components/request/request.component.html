<button class="rounded-md bg-slate-400 text-white px-3 py-1.5 absolute top-18 left-6 text-sm font-medium content-end tracking-widest cursor-pointer hover:bg-slate-500" routerLink="/be">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-slate-200 me-2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
    </svg>BACK</button>
<form #requestForm="ngForm" (ngSubmit)="saveRequest(requestForm)" class="overflow-auto text-sm mt-12">
    <ng-container *ngIf="request">
        <div class="grid grid-cols-12 my-5">
            <div class="col-span-2 ms-5">
            </div>
            <div class="col-span-8">
                <ng-container *ngIf="request?.id">
                    <div class="border border-gray-300 overflow-auto w-full justify-self-center rounded-lg">
                        <table class="border-collapse table-auto w-full text-sm">
                            <tbody class="bg-white dark:bg-slate-800">
                            <tr class="bg-sky-50">
                                <th class="font-normal text-slate-700 text-base py-2">#{{request.id}}</th>
                                <th class="font-normal text-sky-500 text-base py-2">{{request.summary}}</th>
                                <th class="font-normal text-slate-700 text-base py-2">{{request.type | requestTypeTransform}}</th>
                                <th class="font-normal text-slate-700 text-base py-2">
                                    <span class="rounded-full text-white px-3 py-1 font-normal tracking-widest"
                                          [class.bg-teal-500]="request.status === 'NEW'"
                                          [class.bg-lime-600]="request.status === 'ACCEPTED' || request.status === 'READY_FOR_RELEASE' || request.status === 'PUBLISHED'"
                                          [class.bg-red-400]="request.status === 'REJECTED' || request.status === 'APPEAL_REJECTED'"
                                          [class.bg-amber-400]="request.status === 'CLARIFICATION_REQUESTED' || request.status === 'UNDER_APPEAL' || request.status === 'APPEAL_CLARIFICATION_REQUESTED'"
                                          [class.bg-blue-400]="request.status === 'IN_PROGRESS'"
                                          [class.bg-slate-400]="request.status === 'ON_HOLD'"
                                          [class.bg-rose-400]="request.status === 'CLOSED' || request.status === 'WITHDRAWN'">{{request.status | statusTransform}}</span>
                                </th>
                                <th class="font-normal text-slate-700 text-base py-2">{{request.created | date:'yyyy/MM/dd':'UTC'}}</th>
                                <th class="font-normal text-slate-700 text-base py-2">{{request.reporter}}</th>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </ng-container>
                <ng-container *ngIf="!request?.id">
                    <h2 class="text-xl text-slate-700 text-center">New Request</h2>
                </ng-container>
            </div>
            <div class="col-span-2 justify-self-end">
            </div>
        </div>

        <div *ngIf="request.id" class="grid w-2/3 justify-self-center my-5">
            <div class="grid grid-cols-12">
                <div class="col-span-2">
                    <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer" type="button" (click)="displayWorkflowDiagram = true">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 0 1-1.125-1.125v-3.75ZM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-8.25ZM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 0 1-1.125-1.125v-2.25Z" />
                        </svg>WORKFLOW</button>
                    <ng-container *ngIf="displayWorkflowDiagram">
                        <div class="relative z-10" aria-labelledby="dialog-title" role="dialog" aria-modal="true" (click)="displayWorkflowDiagram = false">
                            <div class="fixed inset-0 bg-gray-500/75 transition-opacity" aria-hidden="true"></div>
                            <div class="fixed inset-0 z-10 w-screen overflow-y-auto content-center justify-items-center">
                                <img src="images/workflow.png" class="rounded-lg">
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="col-span-10">
                    <ng-container *ngIf="isStaff(user)">
                        <div class="justify-self-end">
                            <button class="rounded-md bg-rose-400 hover:bg-rose-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('WITHDRAWN')">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-rose-200 me-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                </svg>WITHDRAWN</button>
                            <button class="rounded-md bg-red-400 hover:bg-red-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('REJECTED')">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-red-200 me-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                </svg>REJECTED</button>
                            <ng-container *ngIf="request.status === 'NEW'">
                                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('ACCEPTED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>ACCEPTED</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'ACCEPTED'">
                                <button class="rounded-md bg-amber-400 hover:bg-amber-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('CLARIFICATION_REQUESTED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-amber-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>CLARIFICATION</button>
                                <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('IN_PROGRESS')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>IN PROGRESS</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'CLARIFICATION_REQUESTED'">
                                <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('IN_PROGRESS')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>IN PROGRESS</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'IN_PROGRESS'">
                                <button class="rounded-md bg-rose-400 hover:bg-rose-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('CLOSED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-rose-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>CLOSED</button>
                                <button class="rounded-md bg-slate-400 hover:bg-slate-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('ON_HOLD')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-slate-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>ON HOLD</button>
                                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('READY_FOR_RELEASE')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>READY FOR RELEASE</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'ON_HOLD'">
                                <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('IN_PROGRESS')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>IN PROGRESS</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'READY_FOR_RELEASE'">
                                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('PUBLISHED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>PUBLISHED</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'PUBLISHED'">
                                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('READY_FOR_RELEASE')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>READY FOR RELEASE</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'REJECTED'">
                                <button class="rounded-md bg-amber-400 hover:bg-amber-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('UNDER_APPEAL')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-amber-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>APPEALED</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'UNDER_APPEAL'">
                                <button class="rounded-md bg-red-400 hover:bg-red-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('APPEAL_REJECTED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-red-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>APPEAL REJECTED</button>
                                <button class="rounded-md bg-amber-400 hover:bg-amber-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('APPEAL_CLARIFICATION_REQUESTED')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-amber-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>APPEAL CLARIFICATION</button>
                                <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('IN_PROGRESS')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>IN PROGRESS</button>
                            </ng-container>
                            <ng-container *ngIf="request.status === 'APPEAL_CLARIFICATION_REQUESTED'">
                                <button class="rounded-md bg-amber-400 hover:bg-amber-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('UNDER_APPEAL')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-amber-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>APPEALED</button>
                                <button class="rounded-md bg-blue-400 hover:bg-blue-500 text-white px-3 py-1.5 font-medium content-end tracking-widest ms-5 cursor-pointer" type="button" (click)="moveTask('IN_PROGRESS')">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-blue-200 me-2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                                    </svg>IN PROGRESS</button>
                            </ng-container>
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>

        <div class="border border-gray-300 grid grid-cols-2 gap-6 w-2/3 justify-self-center mt-5 mb-3 bg-sky-50 rounded-lg p-3" *ngIf="mode === ModeType.NEW || request.id">
            <div>
                <label for="summary" class="text-sm text-slate-700 font-medium">Summary<span class="text-red-500 ps-1">*</span></label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                        <input type="text" [disabled]="request.id && isUser(user)" [(ngModel)]="request.summary" name="Summary" id="summary" #summaryInput="ngModel" required class="grow py-1.5 placeholder:text-gray-400 text-slate-700 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)" />
                    </div>
                    <div *ngIf="summaryInput.invalid && summaryInput.touched" class="text-red-500 text-sm">Summary is required.</div>
                </div>
            </div>
            <div>
                <label for="type" class="text-sm text-slate-700 font-medium">Type</label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md px-3 border border-gray-300 bg-lime-50" [class.disabled:bg-lime-100]="request.id && isUser(user)">
                        <select name="Type" id="type" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-9 font-medium" [disabled]="request.id && isUser(user)" [(ngModel)]="formType" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            <option [value]="'add-concept'">Add Concept</option>
                            <option [value]="'add-description'">Add Description</option>
                            <option [value]="'add-relationship'">Add Relationship</option>
                            <option [value]="'add-refset'">Add Refset</option>
                            <option [value]="'change-description'">Change Description</option>
                            <option [value]="'change-relationship'">Change Relationship</option>
                            <option [value]="'change-refset'">Change Refset</option>
                            <option [value]="'inactivate-description'">Inactivate Description</option>
                            <option [value]="'inactivate-relationship'">Inactivate Relationship</option>
                            <option [value]="'other'">Other</option>
                        </select>
                    </div>
                </div>
            </div>
            <div>
                <label for="languageRefset" class="text-sm text-slate-700 font-medium">Language Refset</label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                        <select name="Language Refset" id="languageRefset" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-9 font-medium" [disabled]="request.id && isUser(user)" [(ngModel)]="formLangageRefset" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            <option>Belgian Dutch</option>
                            <option>Belgian French</option>
                            <option>Danish</option>
                            <option>French</option>
                            <option>IE English</option>
                            <option>GB English</option>
                            <option>Maori</option>
                            <option>Norwegian Bokmal</option>
                            <option>Norwegian Nynorsk</option>
                            <option>NZ English</option>
                            <option>Swedish</option>
                            <option>Swiss German</option>
                            <option>Swiss Italian</option>
                            <option>Swiss French</option>
                            <option>US English</option>
                        </select>
                    </div>
                </div>
            </div>
            <div>
                <label for="contextRefset" class="text-sm text-slate-700 font-medium">Context Refset</label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                        <select name="Context Refset" id="contextRefset" [disabled]="request.id && isUser(user)" [(ngModel)]="formContextRefset" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-9 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            <option>BE GP - Dutch</option>
                            <option>BE GP - French</option>
                            <option>NZ Patient Friendly - English</option>
                            <option>SE Chief Complaints</option>
                            <option>SE Dose Unit Abbr.</option>
                            <option>SE Lab Medicine</option>
                            <option>SE Dose Unit Plural</option>
                            <option>SE Medication Prof.</option>
                            <option>SE Medication Common</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-span-2 border-b border-gray-300 -mx-3"></div>

            <ng-container *ngIf="formType === 'add-concept'">
                <div>
                    <label for="newFSN" class="text-sm text-slate-700 font-medium">New FSN<span class="text-red-500 ps-1">*</span></label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <input type="text" name="New FSN" id="newFSN" [disabled]="request.id && isUser(user)" [(ngModel)]="request.newFSN" #newFSNInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                        <div *ngIf="newFSNInput.invalid && newFSNInput.touched" class="text-red-500 text-sm">New FSN is required.</div>
                    </div>
                </div>
                <div>
                    <label for="newPT" class="text-sm text-slate-700 font-medium">New Preferred Term<span class="text-red-500 ps-1">*</span></label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <input type="text" name="New Preferred Term" id="newPT" [disabled]="request.id && isUser(user)" [(ngModel)]="request.newPT" #newPTInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                        <div *ngIf="newPTInput.invalid && newPTInput.touched" class="text-red-500 text-sm">New Preferred Term is required.</div>
                    </div>
                </div>
                <div>
                    <label for="newSynonyms" class="text-sm text-slate-700 font-medium">New Synonyms</label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <input type="text" name="New Synonyms" id="newSynonyms" [disabled]="request.id && isUser(user)" [(ngModel)]="request.newSynonyms" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                    </div>
                </div>
                <div>
                    <label for="parentConcept" class="text-sm text-slate-700 font-medium">Parent Concept<span class="text-red-500 ps-1">*</span></label>
                    <p></p>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <i class="fa-solid text-slate-700 fa-search text-lg pe-2"></i>
                            <input type="text" name="Parent Concept" id="parentConcept" [disabled]="request.id && isUser(user)" [(ngModel)]="request.parentConcept" #parentConceptInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" placeholder="Type to search..." [class.disabled:text-gray-400]="request.id && isUser(user)" (input)="onTypeaheadInput()">
                        </div>
                        <div *ngIf="parentConceptInput.invalid && parentConceptInput.touched" class="text-red-500 text-sm">Parent Concept is required.</div>
                    </div>
                    <ng-container *ngFor="let result of typeaheadResults">
                        <p>{{result}}</p>
                    </ng-container>
                </div>

                <div class="col-span-2 border-b border-gray-300 -mx-3"></div>
            </ng-container>

            <ng-container
                *ngIf="formType === 'add-description' || formType === 'add-relationship' || formType === 'change-description' || formType === 'change-relationship' || formType === 'inactivate-description' || formType === 'inactivate-relationship'">
                <div class="col-span-2">
                    <label for="concept" class="text-sm text-slate-700 font-medium">Concept</label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <i class="fa-solid text-slate-700 fa-search text-lg pe-2"></i>
                            <input type="text" name="Concept" id="concept" [disabled]="request.id && isUser(user)" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" placeholder="Type to search..." [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                    </div>
                </div>
                <div>
                    <label for="conceptId" class="text-sm text-slate-700 font-medium">Concept ID<span class="text-red-500 ps-1">*</span></label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <input type="text" name="Concept ID" id="conceptId" [disabled]="request.id && isUser(user)" [(ngModel)]="request.conceptId" #conceptIdInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                        <div *ngIf="conceptIdInput.invalid && conceptIdInput.touched" class="text-red-500 text-sm">Concept ID is required.</div>
                    </div>
                </div>
                <div>
                    <label for="conceptName" class="text-sm text-slate-700 font-medium">Concept Name<span class="text-red-500 ps-1">*</span></label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <input type="text" name="Concept Name" id="conceptName" [disabled]="request.id && isUser(user)" [(ngModel)]="request.conceptName" #conceptNameInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                        </div>
                        <div *ngIf="conceptNameInput.invalid && conceptNameInput.touched" class="text-red-500 text-sm">Concept Name is required.</div>
                    </div>
                </div>
                <ng-container *ngIf="formType === 'add-description'">
                    <div class="col-span-2">
                        <label for="newDescription" class="text-sm text-slate-700 font-medium">New Description<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="New Description" id="newDescription" [disabled]="request.id && isUser(user)" [(ngModel)]="request.newDescription" #newDescriptionInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="newDescriptionInput.invalid && newDescriptionInput.touched" class="text-red-500 text-sm">New Description is required.</div>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="formType === 'add-relationship'">
                    <div>
                        <label for="relationshipType" class="text-sm text-slate-700 font-medium">Relationship Type<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Relationship Type" id="relationshipType" #relationshipTypeInput="ngModel" required [disabled]="request.id && isUser(user)" [(ngModel)]="request.relationshipType" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="relationshipTypeInput.invalid && relationshipTypeInput.touched" class="text-red-500 text-sm">Relationship Type is required.</div>
                        </div>
                    </div>
                    <div>
                        <label for="relationshipTarget" class="text-sm text-slate-700 font-medium">Relationship Target<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <i class="fa-solid text-slate-700 fa-search text-lg pe-2"></i>
                                <input type="text" name="Relationship Target" id="relationshipTarget" #relationshipTargetInput="ngModel" required [disabled]="request.id && isUser(user)" [(ngModel)]="request.relationshipTarget" class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" placeholder="Type to search..." [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="relationshipTargetInput.invalid && relationshipTargetInput.touched" class="text-red-500 text-sm">Relationship Target is required.</div>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="formType === 'change-description'">
                    <div>
                        <label for="existingDescription" class="text-sm text-slate-700 font-medium">Exisiting Description<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Exisiting Description" id="existingDescription" [disabled]="request.id && isUser(user)" [(ngModel)]="request.existingDescription" #existingDescriptionInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="existingDescriptionInput.invalid && existingDescriptionInput.touched" class="text-red-500 text-sm">Exisiting Description is required.</div>
                        </div>
                    </div>
                    <div>
                        <label for="newChangeDescription" class="text-sm text-slate-700 font-medium">New Description<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="New Description" id="newChangeDescription" [disabled]="request.id && isUser(user)" [(ngModel)]="request.newDescription" #newDescriptionInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="newDescriptionInput.invalid && newDescriptionInput.touched" class="text-red-500 text-sm">New Description is required.</div>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="formType === 'change-relationship'">
                    <div class="col-span-2">
                        <label for="existingRelationship" class="text-sm text-slate-700 font-medium">Exisiting Relationship<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Exisiting Relationship" id="existingRelationship" [disabled]="request.id && isUser(user)" [(ngModel)]="request.existingRelationship" #existingRelationshipInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="existingRelationshipInput.invalid && existingRelationshipInput.touched" class="text-red-500 text-sm">Exisiting Relationship is required.</div>
                        </div>
                    </div>
                    <div>
                        <label for="relationshipChangeType" class="text-sm text-slate-700 font-medium">Relationship Type<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Relationship Change Type" id="relationshipChangeType" [disabled]="request.id && isUser(user)" [(ngModel)]="request.relationshipType" #relationshipChangeTypeInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="relationshipChangeTypeInput.invalid && relationshipChangeTypeInput.touched" class="text-red-500 text-sm">Relationship Change Type is required.</div>
                        </div>
                    </div>
                    <div>
                        <label for="relationshipChangeTarget" class="text-sm text-slate-700 font-medium">Relationship Target<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <i class="fa-solid text-slate-700 fa-search text-lg pe-2"></i>
                                <input type="text" name="Relationship Change Target" id="relationshipChangeTarget" [disabled]="request.id && isUser(user)" [(ngModel)]="request.relationshipTarget" #relationshipChangeTargetInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" placeholder="Type to search..." [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="relationshipChangeTargetInput.invalid && relationshipChangeTargetInput.touched" class="text-red-500 text-sm">Relationship Change Target is required.</div>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="formType === 'inactivate-description'">
                    <div class="col-span-2">
                        <label for="inactivateExistingDescription" class="text-sm text-slate-700 font-medium">Exisiting Description<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Exisiting Description" id="inactivateExistingDescription" [disabled]="request.id && isUser(user)" [(ngModel)]="request.existingDescription" #existingDescriptionInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="existingDescriptionInput.invalid && existingDescriptionInput.touched" class="text-red-500 text-sm">Exisiting Description is required.</div>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="formType === 'inactivate-relationship'">
                    <div class="col-span-2">
                        <label for="inactivateExistingRelationship" class="text-sm text-slate-700 font-medium">Exisiting Relationship<span class="text-red-500 ps-1">*</span></label>
                        <div class="mt-2">
                            <div class="flex items-center rounded-md px-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                                <input type="text" name="Exisiting Relationship" id="inactivateExistingRelationship" [disabled]="request.id && isUser(user)" [(ngModel)]="request.existingRelationship" #existingRelationshipInput="ngModel" required class="grow py-1.5 text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)">
                            </div>
                            <div *ngIf="existingRelationshipInput.invalid && existingRelationshipInput.touched" class="text-red-500 text-sm">Exisiting Relationship is required.</div>
                        </div>
                    </div>
                </ng-container>

                <div class="col-span-2 border-b border-gray-300 -mx-3"></div>
            </ng-container>

            <ng-container *ngIf="formType === 'add-refset' || formType === 'change-refset'">
                <div class="col-span-2">
                    <label for="memberConceptIds" class="text-sm text-slate-700 font-medium">Member Concept Ids (for extensional refsets only)</label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md p-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <textarea type="text" name="Member Concept Ids" id="memberConceptIds" [disabled]="request.id && isUser(user)" [(ngModel)]="request.memberConceptIds" class="grow text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-32 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)"></textarea>
                        </div>
                    </div>
                </div>
                <div class="col-span-2">
                    <label for="eclQuery" class="text-sm text-slate-700 font-medium">ECL Query (for intensional refsets only)</label>
                    <div class="mt-2">
                        <div class="flex items-center rounded-md p-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                            <textarea type="text" name="ECL Query" id="eclQuery" [disabled]="request.id && isUser(user)" [(ngModel)]="request.eclQuery" class="grow text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-32 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)"></textarea>
                        </div>
                    </div>
                </div>
            </ng-container>

            <div class="col-span-2">
                <label for="justification" class="text-sm text-slate-700 font-medium">Justification</label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md p-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                        <textarea type="text" name="Justification" id="justification" [disabled]="request.id && isUser(user)" [(ngModel)]="request.justification" class="grow text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-32 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)"></textarea>
                    </div>
                </div>
            </div>
            <div class="col-span-2">
                <label for="reference" class="text-sm text-slate-700 font-medium">Reference</label>
                <div class="mt-2">
                    <div class="flex items-center rounded-md p-3 border bg-white border-gray-300" [class.disabled:bg-gray-100]="request.id && isUser(user)">
                        <textarea type="text" name="Reference" id="reference" [disabled]="request.id && isUser(user)" [(ngModel)]="request.reference" class="grow text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-32 font-medium" [class.disabled:text-gray-400]="request.id && isUser(user)"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid w-2/3 justify-self-center my-5" *ngIf="mode === ModeType.NEW">
            <div class="justify-self-end">
                <button class="rounded-md bg-red-400 hover:bg-red-500 text-white px-3 py-1.5 font-medium content-end tracking-widest me-5 cursor-pointer" (click)="resetForm(requestForm)" type="button">RESET</button>
                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer" type="submit">SUBMIT</button>
            </div>
        </div>

        <div class="grid w-2/3 justify-self-center my-5" *ngIf="request.id">
            <div class="justify-self-end">
                <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer">SAVE</button>
            </div>
        </div>

        <ng-container *ngIf="mode !== ModeType.NEW">
            <div class="grid w-2/3 justify-self-center my-5">
                <h2 class="text-xl text-slate-700">Comments</h2>
                <p *ngIf="requestComments.length === 0" class="p-5 text-center text-gray-500">- There are no comments on this request yet -</p>
                <ng-container *ngFor="let comment of requestComments">
                    <div class="my-3">
                        <ng-container *ngIf="user.login === comment.user">
                            <p class="ms-3 font-medium">{{comment.user}} <span class="text-gray-500 text-sm font-normal ms-2">{{comment.created | date:'yyyy/MM/dd, h:mm a':'UTC'}}</span></p>
                            <div class="border border-lime-300 bg-lime-100 rounded-lg">
                                <p class="p-3">{{comment.body}}</p>
                            </div>
                        </ng-container>
                        <ng-container *ngIf="user.login !== comment.user">
                            <p class="ms-3 font-medium">{{comment.user}} <span class="text-gray-500 text-sm font-normal ms-2">{{comment.created | date:'yyyy/MM/dd, h:mm a':'UTC'}}</span></p>
                            <div class="border border-sky-200 bg-sky-100 rounded-lg">
                                <p class="p-3">{{comment.body}}</p>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>

                <div class="flex items-center rounded-md p-3 border border-gray-300 my-5">
                    <textarea type="text" name="comment" class="grow text-slate-700 placeholder:text-gray-400 focus:outline-none sm:text-sm/6 h-24 font-medium" placeholder="Type your comment here..." [(ngModel)]="comment"></textarea>
                </div>

                <div class="justify-self-end">
                    <button class="rounded-md bg-lime-600 hover:bg-lime-700 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer justify-self-start" type="button" (click)="postComment()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" />
                        </svg>ADD COMMENT</button>
                </div>
            </div>
        </ng-container>
    </ng-container>
</form>
