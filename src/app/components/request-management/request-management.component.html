<div class="overflow-auto text-sm mt-12">
    <div class="grid grid-cols-8 m-5">
        <div class="col-span-2 m-3">
            <h2 class="text-xl text-slate-700 p-2">Belgium's Requests</h2>
        </div>
        <div class="col-span-4 m-3">
            <input class="text-slate-500 text-base w-full bg-gray-100 border rounded-full py-2 px-3 border-gray-300" [(ngModel)]="searchText" placeholder="Search..." (input)="onSearchInput()">
        </div>
        <div class="col-span-2 m-3 justify-self-end">
            <button class="rounded-md bg-lime-600 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer hover:bg-lime-700" routerLink="/{{country}}/new-request">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-lime-400 me-2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>NEW REQUEST</button>
        </div>
    </div>
    <div class="border border-gray-300 overflow-auto m-5 rounded-lg">
        <table class="border-collapse table-auto w-full text-sm">
            <thead>
                <tr class="overflow-hidden">
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">ID</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">REQUEST</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">TYPE</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">STATUS</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">DATE</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2">USER</th>
                    <th class=" bg-gray-100 border-b border-gray-300 font-normal text-base py-2"></th>
                </tr>
            </thead>
            <tbody class="bg-white dark:bg-slate-800">
                <tr *ngFor="let request of requests; let last = last" routerLink="/{{country}}/{{request.id}}" class="hover:bg-sky-50 hover:cursor-pointer text-center">
                    <td class="border-gray-300 font-normal text-slate-700 text-base py-2" [class.border-b]="!last">#{{request.id}}</td>
                    <td class="border-gray-300 font-normal text-sky-500 text-base py-2" [class.border-b]="!last">{{request.summary}}</td>
                    <td class="border-gray-300 font-normal text-slate-700 text-base py-2" [class.border-b]="!last">{{request.type | requestTypeTransform}}</td>
                    <td class="border-gray-300 font-normal text-slate-700 text-base py-2" [class.border-b]="!last">
                        <span class="rounded-full text-white px-3 py-1 font-normal tracking-widest"
                              [class.bg-teal-500]="request.status === 'NEW'"
                              [class.bg-lime-600]="request.status === 'ACCEPTED' || request.status === 'READY_FOR_RELEASE' || request.status === 'PUBLISHED'"
                              [class.bg-red-400]="request.status === 'REJECTED' || request.status === 'APPEAL_REJECTED'"
                              [class.bg-amber-400]="request.status === 'CLARIFICATION_REQUESTED' || request.status === 'UNDER_APPEAL' || request.status === 'APPEAL_CLARIFICATION_REQUESTED'"
                              [class.bg-blue-400]="request.status === 'IN_PROGRESS'"
                              [class.bg-slate-400]="request.status === 'ON_HOLD'"
                              [class.bg-rose-400]="request.status === 'CLOSED' || request.status === 'WITHDRAWN'">{{request.status | statusTransform}}</span>
                    </td>
                    <td class="border-gray-300 font-normal text-slate-700 text-base py-2" [class.border-b]="!last">{{request.created | date:'yyyy/MM/dd':'UTC'}}</td>
                    <td class="border-gray-300 font-normal text-slate-700 text-base py-2" [class.border-b]="!last">{{request.reporter}}</td>
                    <td class="border-gray-300 font-normal text-slate-700" [class.border-b]="!last">
                        <i class="fas fa-times text-2xl text-red-500" (click)="deleteOption = request; $event.stopPropagation()"></i>
                    </td>
                </tr>
                <tr *ngIf="requests.length === 0 && !requestLoading">
                    <td colspan="7" class="text-center text-gray-500 py-4">No requests found.</td>
                </tr>
                <tr *ngIf="requestLoading">
                    <td colspan="7" class="text-center text-gray-500 py-4">Retrieving requests...</td>
                </tr>
            </tbody>
        </table>
    </div>
    <ng-container *ngIf="!requestLoading">
        <div class="text-center">
            <button class="rounded-md bg-slate-400 text-white px-3 py-1.5 font-medium content-end tracking-widest cursor-pointer hover:bg-slate-500 disabled:bg-slate-300" disabled [disabled]="totalRequests <= visibleRequests" (click)="loadMore()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 inline text-slate-200 me-2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3" />
                </svg>
LOAD MORE</button>
        </div>
    </ng-container>
</div>

<div *ngIf="deleteOption">
    <div class="relative z-10" aria-labelledby="dialog-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-gray-500/75 transition-opacity" aria-hidden="true"></div>
        <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
                    <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                        <div class="sm:flex sm:items-start">
                            <div class="mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:size-10">
                                <svg class="size-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                                </svg>
                            </div>
                            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                                <h3 class="text-base font-semibold text-gray-900" id="dialog-title">Delete Request #{{deleteOption.id}}</h3>
                                <div class="mt-2">
                                    <p class="text-sm text-gray-500">Are you sure you want to delete this request?</p>
                                    <p class="pt-3 text-center text-sky-600">{{deleteOption.summary}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 px-3 py-3 sm:flex sm:flex-row-reverse">
                        <button type="button" class="inline-flex justify-center rounded-md bg-red-500 px-3 py-2 text-sm font-medium text-white hover:bg-red-600 hover:cursor-pointer sm:ml-3 sm:w-auto" (click)="deleteRequest(deleteOption)">DELETE</button>
                        <button type="button" class="mt-3 inline-flex justify-center rounded-md bg-white px-3 py-2 text-sm font-medium ring-1 ring-gray-300 ring-inset hover:bg-gray-50 hover:cursor-pointer sm:mt-0 sm:w-auto" (click)="deleteOption = null">CANCEL</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
